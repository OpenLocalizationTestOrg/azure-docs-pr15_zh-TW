<properties
   pageTitle="延展性檢查清單 |Microsoft Azure"
   description="擴充的檢查清單指南的設計考量 Azure 自動調整。"
   services=""
   documentationCenter="na"
   authors="dragon119"
   manager="christb"
   editor=""
   tags=""/>

<tags
   ms.service="best-practice"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="07/13/2016"
   ms.author="masashin"/>

# <a name="scalability-checklist"></a>延展性檢查清單

[AZURE.INCLUDE [pnp-header](../includes/guidance-pnp-header-include.md)]

## <a name="service-design"></a>服務設計
- **分割的工作量**。 設計為不連續和 decomposable 的程序的部分。 [最小化各部分，的大小時追蹤區隔疑慮和單一責任原則的主要規則。 如此會最大化的每個的計算單位 （例如角色或資料庫伺服器） 使用的方式散發元件組件。 這也可讓它容易不按比例縮放藉由新增特定的資源的執行個體的應用程式。 如需詳細資訊，請參閱[計算分割指引](https://msdn.microsoft.com/library/dn589773.aspx)。
- **縮放比例的設計**。 縮放比例可讓應用程式，以反應變數載入增加和減少的角色的執行個體數目佇列中，並使用其他服務。 不過，應用程式必須注意設計工作。 比方說，應用程式，並使用的服務必須是狀態時，若要允許傳送至任何執行個體的要求。 這也可防止新增或移除特定的執行個體的負面影響目前的使用者。 您也應該實作設定] 或 [自動偵測的執行個體如新增及移除，讓應用程式中的程式碼可以執行必要路由。 例如，web 應用程式可能會使用佇列的一組循環路由執行工作者角色中的背景服務的要求。 Web 應用程式必須能夠偵測佇列中，若要順利路由要求及平衡應用程式上的載入數的變更。
- **為單位的小數位數**。 其他資源，以容納等比級數計劃。 針對各個資源，知道右上縮放限制，並使用 sharding 或分解為試試這些限制。 決定龐大的資源妥善定義集系統的刻度] 單位。 如此可讓套用擴充作業更簡單且更容易產生負面影響整體系統的一些組件中所缺乏資源施加限制透過應用程式上。 例如，新增 x 的網頁和背景工作角色數目可能需要額外的佇列 y 數] 及 [z 數字的儲存空間處理角色所產生的其他工作負載的帳戶。 讓刻度] 單位可能包含 x 的網頁和背景工作的角色與_y_佇列_z_儲存帳戶。 設計應用程式，以便輕鬆地進行縮放藉由新增一或多個刻度] 單位。
- **避免用戶端關聯性**。 可能的話，請確定應用程式不需要相關性。 要求因此被路由至任何執行個體，並不相關的執行個體數目。 這也可避免儲存、 擷取，以及維護為每位使用者的狀態資訊的成本。
- **利用平台自動縮放功能**。 主機服務的平台支援自動縮放功能，例如 Azure 自動調整大小的位置，除非的內建機制無法滿足您的需求偏好自訂或協力廠商機制。 使用排程的縮放比例規則，以確保資源可能可而不會啟動延遲，但新增反應自動縮放的規則應付非預期的變更，視需要在適當的位置。 若要調整自動縮放，並新增自訂的計數器規則，您可以使用自動縮放作業服務管理 API 中。 如需詳細資訊，請參閱[自動調整大小的指示](best-practices-auto-scaling.md)。
- **卸載需要大量 CPU/IO 工作為背景的工作**。 如果服務的要求預期長的時間執行或吸收相當大的資源，下載這個個別的工作要求的處理。 使用背景工作角色] 或 [背景工作 （根據裝載的平台） 來執行這些工作。 這種方法可讓服務繼續收到其他要求，並保持回應。  如需詳細資訊，請參閱[背景的工作指示](best-practices-background-jobs.md)。
- **分散工作負載的背景的工作**。 其中有許多背景的工作或工作需要很長的時間] 或 [資源]，將工作分散 （例如工作者角色或背景的工作） 的多個計算單位。 一個可能的解決方案，請參閱[競爭消費者圖樣](https://msdn.microsoft.com/library/dn568101.aspx)。
- **考慮朝著_無共用_架構**。 無共用架構使用獨立、 市場有 （例如共用的服務或儲存空間） 競爭沒有單一點的節點。 理論上，這類系統可以幾乎無限期調整。 雖然無完全共用方法通常不是適用於大部分的應用程式，它可能會提供更好的延展性設計的商機。 例如，避免使用伺服器端工作階段狀態，用戶端關聯性，和資料分割是很好的範例朝著無共用架構。

## <a name="data-management"></a>資料管理

- **使用分割的資料**。 跨多個資料庫與資料庫伺服器，將資料，或用資料的儲存空間的應用程式服務的設計可以提供此分割無障礙 （範例包括 Azure SQL 資料庫彈性資料庫和 Azure 資料表儲存體）。 這種方法可以協助最佳化效能，並讓您更容易縮放比例。 有一些不同分割技巧，例如 [水平、 垂直和功能。 獲得提高的查詢效能、 簡單延展性、 更有彈性的管理、 更好的顯示狀態，從最大優勢和存放區，它會保留的資料類型，您可以使用這些項目的組合。 此外，請考慮使用不同的資料類型，選擇 [根據他們如何最佳化特定類型的資料類型不同類型的資料存放區。 這可能包括使用資料表儲存體、 文件資料庫或資料行系列資料存放區，而不是，或是也為關聯式資料庫。 如需詳細資訊，請參閱[資料分割指引](best-practices-data-partitioning.md)。
- **設計的一致性**。 一致性改善延展性減少或移除同步處理多個儲存過分割的相關的資料所需的時間。 成本為，資料不一定一致時，讀取及部分撰寫作業可能會導致衝突。 一致性適合的情況下，相同的資料是經常閱讀，但不常撰寫。 如需詳細資訊，請參閱[資料一致性入門](https://msdn.microsoft.com/library/dn589800.aspx)。
- **縮減談話互動之間元件和服務**。 避免設計需要多個打電話服務應用程式的互動 （每一種將傳回少量的資料），而不是單一呼叫可以傳回的所有資料。 服務或有明顯的延遲元件通話時，可能的話，合併到單一要求的多個相關的作業。 如此可讓您更容易監控效能和最佳化複雜的作業。 例如，封裝複雜的邏輯，在資料庫中使用預存程序，並減少往返和資源鎖定。
- **使用佇列撫平高速度資料寫入的載入**。 可在服務要求可以會使不勝負荷該服務，並會導致難題失敗。 若要避免此問題，請考慮實作[佇列型負載撫平模式](https://msdn.microsoft.com/library/dn589783.aspx)。 使用佇列做為緩衝任務之間的服務，它會叫用。 這可以平滑間歇性發生失敗的服務或逾時的工作，否則可能會導致的高度負載。
- **最小化的資料存放區上的載入**。 資料儲存區通常是處理瓶頸，成本資源，及擴充通常並不容易。 可能的話，移除資料存放區中的邏輯 （例如處理 XML 文件] 或 [JSON 物件），然後執行應用程式內的處理。 例如，而非傳遞 XML 資料庫 （而不是為儲存空間不透明字串），序列化或還原序列化應用程式層級的 XML 和傳入的表單，則原生資料存放區。 會擴充的資料存放區中，於應用程式，您應該嘗試執行中的應用程式內盡可能運算密集處理通常是很容易。
- **最小化的資料擷取完成**。 擷取您需要指定資料行，並以選取列中使用準則的資料。 請使用表格值參數，以及適當的隔離層級。 使用機制等實體標籤，以避免不必要擷取資料。
- **積極使用 [快取**。 使用快取盡可能降低負載資源和服務的產生或傳送的資料。 通常適用於較靜態，或需要很長的處理，以取得的資料快取。 快取應該會發生所有層級的應用程式，包括資料存取和使用者介面產生的各個圖層中適當的位置。 如需詳細資訊，請參閱[快取的指引](best-practices-caching.md)。
- **處理資料成長和保留**。 一段時間的規模擴大時的應用程式所儲存的資料量。 此等比級數增加儲存空間的成本，並增加延遲，存取資料時，其會影響應用程式處理量與效能。 可能會定期封存舊的資料無法再存取的部分，或將很少存取資料移到長期是有效率的其他成本，即使存取延遲較高的儲存空間。
- **最佳化資料傳送物件 (DTOs) 使用有效的二進位格式**。 DTOs 之間傳送應用程式的圖層的次數。 最小化大小會減少資源和網路上的載入。 不過，平衡將資料轉換成，使用每個位置中所需格式的虛儲蓄。 採用具有最大的互通性啟用元件的輕鬆地重複使用的格式。
- **設定 [快取控制項**。 設計並設定應用程式使用輸出快取或片段快取可能的話，最小化處理載入。
- **啟用 [用戶端快取**。 Web 應用程式應該啟用上的內容，可快取的快取設定。 這通常會依預設停用。 設定伺服器進行適當的快取以啟用快取的 proxy 伺服器和用戶端上的內容控制項標題。
- **使用 Azure blob 儲存體和 Azure 內容傳遞網路以減少應用程式上的載入**]。 請考慮將靜態或相對靜態公用內容，例如圖像、 資源、 指令碼及樣式表，儲存在 blob 儲存體。 這種方法讓負載所造成的動態產生的每個要求這個內容的應用程式。 此外，請考慮使用快取此內容，並將其傳送給用戶端內容傳遞網路。 使用內容傳遞網路可以改善效能在用戶端，因為內容已傳送的地理位置最接近的資料中心包含內容傳遞網路快取。 如需詳細資訊，請參閱[內容傳遞網路指引](best-practices-cdn.md)。
- **最佳化和微調 SQL 查詢的索引**。 部分 T SQL 陳述式或架構，就可能會影響於減少最佳化預存程序中的程式碼的效能。 例如，避免將**datetime**類型轉換成**varchar**之前比較**datetime**常值。 請改用日期/時間比較函數。 缺少的適當索引也會變慢執行查詢。 如果您使用的物件/關聯的對應架構，瞭解其運作方式可能影響效能資料的存取層級。 如需詳細資訊，請參閱[查詢微調](https://technet.microsoft.com/library/ms176005.aspx)。
- **考慮就能取消正常化資料**。 資料正常化可協助避免重複及不一致。 不過，維護多個索引、 檢查參考完整性、 執行多個小區塊的資料，存取及加入重新資料的表格會採用可能會影響效能成本。 請考慮一些額外的儲存空間音量和重複是否可接受，以減少資料存放區上的載入。 此外，請考慮是否應用程式本身 （這是通常是很容易不按比例縮放） 可依賴控制工作，例如以減少資料存放區上的載入管理參考完整性。 如需詳細資訊，請參閱[資料分割指引](https://github.com/mspnp/azure-guidance/blob/master/Data%20partitioning.md)。

## <a name="service-implementation"></a>服務實作
- **使用非同步呼叫**。 盡可能存取資源或服務，可能會受限於 I/O 或網路頻寬，或同時有明顯的延遲時間，以避免鎖定呼叫執行緒時，使用非同步的程式碼。 若要實作非同步作業，請使用[工作式非同步模式 （點選）](https://msdn.microsoft.com/library/hh873175.aspx)。
- **避免鎖定資源，並請改為使用樂觀工期的方法**。 從未鎖定存取資源，例如儲存空間或其他有明顯的延遲時間，因為這是主要原因的效能不佳的服務。 一律使用樂觀工期的方法，來管理並行作業，例如寫入儲存空間。 使用儲存空間圖層的功能來管理衝突。 在分散式應用程式，資料可能僅最後一致。
- **壓縮在高延遲，低頻寬網路高度壓縮的資料**。 在大多數的情況下，在 web 應用程式中，最大的應用程式所產生的資料，並透過網路傳遞音量 HTTP 回應用戶端的要求。 HTTP 壓縮降低這大幅，特別是的靜態內容。 這可以降低成本，以及減少在網路上的載入雖然壓縮動態內容並套用負載 fractionally 更高的伺服器上。 在其他、 其他通用環境中，資料壓縮可以減少的資料傳輸，最小化傳輸的時間和成本，但壓縮和解壓縮的程序導致負荷。 因此，效能 demonstrable gain 時，應該只能用於壓縮。 其他序列化方法，例如 JSON 或二進位編碼，可能會縮小內容時有較少的影響效能，而 XML 則是可能會增加。
- **最小化連線與資源所使用的時間**。 維護連線與僅適用於資源，只要您需要使用它們。 例如，開啟 [越慢越好，連線，讓他們越快越傳回連接集區。 越慢越好，取得資源和儘快處理它們。
- **所需的最小化的數目**。 服務連線吸收資源。 限制必要，並確保儘現有的連線會重複使用的數字。 例如，執行後驗證，使用模擬以特定身分執行程式碼。 這可協助進行連接共用的最佳使用重複使用的連線。

    > [AZURE.NOTE]: APIs for some services automatically reuse connections, provided service-specific guidelines are followed. It's important that you understand the conditions that enable connection reuse for each service that your application uses.

- **傳送邀請最佳化網路使用的批次**。 例如，傳送閱讀存取佇列中，以批次的郵件，並多個讀取或寫入以批次時執行存取儲存空間或快取。 這有助於在網路上減少的呼叫數目最佳化的服務與資料存放區的效能。
- **避免要求儲存伺服器端工作階段狀態**可能的位置。 伺服器端工作階段狀態管理通常需要用戶端關聯性 （也就，為相同的伺服器執行個體路由每一條），這會影響系統的不按比例縮放的能力。 理想的情況下，您應該設計沒有狀態與他們使用之伺服器的用戶端。 不過，如果應用程式必須維持工作階段狀態，請儲存機密資料或大量的每個用戶端資料分散式伺服器端快取中可存取應用程式的所有例項。
- **最佳化資料表儲存體結構描述**。 使用需要傳遞並使用每個查詢，例如 Azure 資料表儲存體，處理資料表和資料行名稱的表格儲存時請考慮使用較短名稱可以降低此費用。 不過，不要犧牲可讀性或管理使用過度精簡的名稱。
- **使用工作平行文件庫 (TPL) 執行非同步作業**。 TPL 可讓您更輕鬆地撰寫非同步執行 O 繫結作業的程式碼。 儘可能使用_ConfigureAwait(false)_以利消除接續在特定的同步處理內容的相依性。 這會減少執行緒死結發生的可能性。
- **建立資源相依性部署時，或在應用程式啟動**。 避免重複的來電至] 來測試的資源存在及不存在，然後建立資源的方法。 （例如_CloudTable.CreateIfNotExists_和_CloudQueue.CreateIfNotExists_ Azure 儲存用戶端的文件庫中的方法遵循此模式）。 如果他們叫用之前儲存的表格或儲存空間佇列中每個存取，這些方法可以強制相當大的費用。 請改為︰
 - 建立所需的資源，應用程式部署時，或第一次啟動時 （ _CreateIfNotExists_啟動程式碼的網頁或背景工作角色中的每個資源在單一通話為可接受）。 不過，請務必處理您的程式碼嘗試存取不存在的資源，有可能會發生的例外狀況。 在下列情況下，您應該記錄的例外狀況，並可能提醒運算子資源會遺失。
 - 在某些情況下，可能適合用於建立遺失資源的例外處理程式碼的一部分。 但非-存在資源的可能表示程式設計錯誤 （例如拼錯的資源名稱） 或其他基礎結構層級問題時，應採用謹慎使用此方法。
- **使用輕量型架構**。 謹慎選擇 Api 與架構您使用最小化 [資源使用狀況、 執行時間和整體載入到應用程式]。 例如使用 Web API 處理服務要求可以負荷應用程式，並增加執行速度，但可能適用於 Windows Communication Foundation 的其他功能在哪裡必要的進階案例。
- **考慮最小化服務帳戶的數目**。 例如，使用特定帳戶存取資源或服務的限制，限制連線]，或執行較高的位置會維持較少的連線。 這個方法最常見的服務資料庫，例如，但它會影響對於稽核作業，因為模擬原始使用者的能力。
- 在開發期間，一部分的測試常式，以確保應用程式所執行的最終版本，並視需要調整之前**按照效能剖析和負載測試**。 這項測試應該在相同類型的硬體生產平台與相同類型，以及大量資料與使用者載入時，會發生生產環境中。 如需詳細資訊，請參閱[測試雲端服務的效能](vs-azure-tools-performance-profiling-cloud-services.md)。
