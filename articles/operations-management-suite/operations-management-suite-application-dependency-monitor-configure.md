<properties
   pageTitle="在 [作業管理套件 (OMS) 中設定應用程式相依性監視器 (ADM) |Microsoft Azure"
   description="應用程式相依性監視器 (ADM) 是一種作業管理套件 (OMS) 解決方案，自動探索 Windows 和 Linux 系統上的應用程式元件和地圖服務之間的通訊。  本文提供您的環境中部署 ADM 與它在許多情況下使用詳細資料。"
   services="operations-management-suite"
   documentationCenter=""
   authors="daseidma"
   manager="jwhit"
   editor="tysonn" />
<tags
   ms.service="operations-management-suite"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="09/28/2016"
   ms.author="daseidma;bwren" />

# <a name="configuring-application-dependency-monitor-solution-in-operations-management-suite-oms"></a>設定應用程式相依性監視器解決方案中作業管理套件 (OMS)
![管理通知] 圖示](media/operations-management-suite-application-dependency-monitor/icon.png) 應用程式相依性監視器 (ADM) 自動探索 Windows 和 Linux 系統上的應用程式元件和地圖服務之間的通訊。 其可讓您檢視您的伺服器，當您將這些視為互連式傳送重要的服務的系統。  應用程式相依性監視器顯示伺服器，處理程序，之間的連線，並在沒有設定任何 TCP 連接的架構的連接埠所需代理程式的安裝以外。

本文將說明設定應用程式相依性監視器] 和 [登入代理程式的詳細資料。  使用 ADM 資訊，請參閱[使用應用程式相依性監視器解決方案中作業管理套件 (OMS)](operations-management-suite-application-dependency-monitor.md)

>[AZURE.NOTE]應用程式相依性監視器目前正在私人的預覽。  您可以要求存取[https://aka.ms/getadm](https://aka.ms/getadm)ADM 私人預覽。
>
>私人預覽，在所有 OMS 帳戶都有 ADM.無限制的存取  ADM 節點免費提供，但會計量付費 AdmComputer_CL 和 AdmProcess_CL 類型的記錄檔分析資料，例如任何其他方案。
>
>ADM 輸入公用預覽之後，會使用免費與付費的充分並分析 OMS 價格計劃中的客戶。  免費層帳戶會限制為 5 ADM 節點。  如果您正在參與私人的預覽，無法註冊 OMS 價格計劃中 ADM 進入公用預覽時，會在該時間停用 ADM。 



## <a name="connected-sources"></a>連線的來源
下表說明連線支援 ADM 解決方案的來源。

| 連線的來源 | 支援 | 描述 |
|:--|:--|:--|
| [Windows 代理程式](../log-analytics/log-analytics-windows-agents.md) | [是] | ADM 分析，並從 Windows 代理程式的電腦收集資料。  <br><br>請注意，除了 OMS 代理程式 Windows 代理程式需要 Microsoft 相依性代理程式。  請參閱[支援的作業系統](#supported-operating-systems)的作業系統版本的完整清單。 |
| [Linux 代理程式](../log-analytics/log-analytics-linux-agents.md) | [是] | ADM 分析，並從 Linux 代理程式的電腦收集資料。  <br><br>請注意，除了 OMS 代理程式 Linux 代理程式需要 Microsoft 相依性代理程式。  請參閱[支援的作業系統](#supported-operating-systems)的作業系統版本的完整清單。 |
| [是 SCOM 管理群組](../log-analytics/log-analytics-om-agents.md) | [是] | ADM 分析，並從連線的是 SCOM 管理群組中的 Windows 和 Linux 代理程式收集資料。 <br><br>直接從是 SCOM 代理程式電腦連線到 OMS 資格。 資料會傳送直接從管理群組轉寄至 OMS 存放庫。|
| [Azure 儲存體帳戶](../log-analytics/log-analytics-azure-storage.md) | 無 | ADM 從代理程式的電腦收集資料，讓它，從 Azure 儲存體收集沒有資料。 |

請注意，ADM 僅支援 64 位元平台。

在 Windows 上，Microsoft 監控代理程式 (MMA) 由是 SCOM 和 OMS 用來收集資料，並傳送監視資料。  （此代理程式稱為是 SCOM 代理程式、 OMS 代理程式、 MMA 或直接代理程式，根據內容而定）。 是 SCOM 和 OMS 提供不同版本的 MMA，登出，但這些版本可以是 SCOM、 OMS，或兩者的每個報表。  Linux、 Linux 收集並監控 OMS 資料給 OMS 代理人。  您可以使用 ADM，或附加至 OMS 透過是 SCOM 管理群組的伺服器上 OMS 直接代理程式的伺服器。  針對此文件中，我們將所有這些代理程式-上 Linux 或視窗，無論是 SCOM MG 或直接 OMS – 連接為 「 OMS 代理人，」，除非特定部署名稱代理程式的所需的內容。

ADM 代理程式不會傳輸本身的任何資料，並不需要防火牆或連接埠的任何變更。  ADM 的資料永遠會傳送至 OMS，OMS 代理程式直接或透過 OMS 閘道器。

![ADM 代理程式](media/operations-management-suite-application-dependency-monitor/agents.png)

如果您是連線到 OMS 管理群組是 SCOM 客戶︰

- 如果您是 SCOM 代理程式能夠存取網際網路連線至 OMS，其他就不需要設定。  
- 如果您是 SCOM 代理程式無法透過網際網路存取 OMS，您必須設定為搭配使用的是 SCOM OMS 閘道器。
  
如果您使用的 OMS 直接代理程式，您需要設定 OMS 代理連線至 OMS 或 OMS 閘道。  您可以從[https://www.microsoft.com/en-us/download/details.aspx?id=52666](https://www.microsoft.com/en-us/download/details.aspx?id=52666)下載 OMS 閘道器


### <a name="avoiding-duplicate-data"></a>避免重複的資料

如果您是 SCOM 客戶，您應該設定直接與通訊 OMS，您是 SCOM 代理程式，或按兩次報告資料。  在 ADM，這會導致出現在 [電腦] 清單中按兩次的電腦。

設定 OMS 應該在下列位置其中之一︰

- 受管理的電腦上的 [是 SCOM 主控台作業管理套件] 面板
- Azure MMA 屬性中的操作的深入見解設定

使用相同的工作區中每個兩種設定會導致重複的資料。 使用同時以不同的工作區，可能會導致可能會防止資料完全流向 ADM 的衝突設定 （與啟用 ADM 方案不含其他項目）。  

請注意，即使作用中的執行個體群組，例如 「 Windows Server 執行個體組成群組 」 時，不會在是 SCOM 主控台 OMS 設定中，指定電腦本身，它可能仍導致電腦接收 OMS 組態透過是 SCOM。



## <a name="management-packs"></a>管理組件
ADM 啟動時 OMS 工作區中，300 KB Management Pack 會傳送給所有 Microsoft 監控代理程式的工作區中。  如果您使用是 SCOM 代理程式中的[已連線的管理群組](../log-analytics/log-analytics-om-agents.md)，將會從是 SCOM 部署 ADM Management Pack。  如果代理程式已直接連接，OMS 會傳遞 MP。

MP 名稱為 Microsoft.IntelligencePacks.ApplicationDependencyMonitor*。 寫入*%Programfiles%\Microsoft 監控 Agent\Agent\Health State\Management Service\*。  使用管理封包的資料來源是*%程式 files%\Microsoft 監控 Agent\Agent\Health 服務 State\Resources\<AutoGeneratedID > \Microsoft.EnterpriseManagement.Advisor.ApplicationDependencyMonitorDataSource.dll*。



## <a name="configuration"></a>設定
除了 Windows 和 Linux 電腦的代理安裝並連線到 OMS，必須從 ADM 解決方案下載，然後安裝在每個受管理的伺服器上的 [為根] 或 [管理員相依性代理程式安裝程式]。  報告 OMS 在伺服器上安裝 ADM 代理程式之後，ADM 相依性地圖會顯示在 10 分鐘內。  如果您有任何問題，請以電子郵件[oms-adm-support@microsoft.com](mailto:oms-adm-support@microsoft.com)。


### <a name="migrating-from-bluestripe-factfinder"></a>從 BlueStripe FactFinder 升級
應用程式相依性監視器會傳送到 OMS BlueStripe 技術階段。 FactFinder 仍現有客戶支援，但已不再提供個別購買。  相依性代理程式的這個預覽版本只可與 OMS 通訊。  如果您目前的 FactFinder 客戶，請用的不受 FactFinder ADM 識別一組測試伺服器。 

### <a name="download-the-dependency-agent"></a>下載相依性代理程式
除了 Microsoft 管理代理程式 (MMA)，其中提供電腦和 OMS 之間的連線 OMS Linux 代理程式所有分析應用程式相依性監視器的電腦必須已安裝的相依性代理程式。  在 Linux，Linux OMS 代理人必須安裝之前相依性代理程式。 

![應用程式相依性監視器方磚](media/operations-management-suite-application-dependency-monitor/tile.png)

若要下載相依性代理程式，請按一下 [開啟**相依性代理程式**刀的**應用程式相依性監視器**磚中的 [**設定方案**]。  相依性代理程式刀有 for Windows 和 Linux 代理程式的連結。 按一下適當的連結，以下載每個代理程式。 在不同系統上安裝代理程式，請參閱下列各節，如需詳細資訊。

### <a name="install-the-dependency-agent"></a>安裝相依性代理程式

#### <a name="microsoft-windows"></a>Microsoft Windows
系統管理員權限，才能安裝或解除安裝代理程式。

相依性代理程式已安裝的 ADM-代理程式-Windows.exe 的 Windows 電腦上。 如果您執行此可執行，而不需要任何選項，則會啟動精靈，您可以遵循互動的方式執行安裝。  

若要在每個 Windows 電腦上安裝相依性代理程式中使用下列步驟。

1.  請確定在連線電腦直接 OMS 使用的指示安裝 OMS 代理程式。
2.  下載 Windows 代理程式，並執行下列命令。<br>*--Windows.exe ADM 代理程式*
3.  依照精靈的指示安裝代理程式。
4.  如果相依性代理程式無法啟動，請核取詳細的錯誤資訊的記錄。 在 Windows 代理記錄目錄會是*C:\Program Files\BlueStripe\Collector\logs*。 

相依性代理程式的 Windows 可以由系統管理員透過 [控制台] 解除安裝。


#### <a name="linux"></a>Linux
根存取，才能安裝或設定代理程式。

相依性代理程式已安裝的 ADM-代理程式-Linux64.bin，以自動解壓縮的二進位 shell 指令碼的 Linux 電腦上。 您可以執行檔案 sh 或新增執行檔案本身的權限。
 
若要在每個 Linux 電腦上安裝相依性代理程式中使用下列步驟。

1.  請確定 OMS 代理程式已安裝在[收集使用的指示及管理資料從 Linux 電腦。 這需要安裝之前 Linux 相依性代理程式](https://technet.microsoft.com/library/mt622052.aspx)。
2.  使用下列命令的根安裝 Linux 相依性代理程式。<br>*sh ADM-代理程式-Linux64.bin*。
3.  如果相依性代理程式無法啟動，請核取詳細的錯誤資訊的記錄。 Linux 代理程式，在記錄目錄是*/var/opt/microsoft/dependency-agent/log*。

### <a name="uninstalling-the-dependency-agent-on-linux"></a>解除安裝 Linux 的相依性代理程式
若要從 Linux 完全解除安裝相依性代理程式，您必須移除代理程式本身，會自動安裝代理程式的 proxy。  您可以同時使用了下列的單一命令解除安裝。

    rpm -e dependency-agent dependency-agent-connector


### <a name="installing-from-a-command-line"></a>安裝從命令列
上一節提供指示安裝相依性監視器代理程式使用預設選項。  以下各節提供的指導方針安裝代理程式從命令列使用自訂的選項。

#### <a name="windows"></a>Windows
若要從命令列執行安裝使用下表中的選項。 若要查看一份安裝旗標執行安裝程式，與 / 嗎？ 加上標幟，如下所示。

    ADM-Agent-Windows.exe /?

| 旗標 | 描述 |
|:--|:--|
| /S | 執行沒有使用者提示靜音自動安裝。 |

根據預設，Windows 相依性代理程式的檔案會放置在*C:\Program Files\BlueStripe\Collector* 。


#### <a name="linux"></a>Linux
請使用下表中的選項來執行安裝。 若要查看一份安裝旗標執行安裝程式-說明標幟，如下所示。

    ADM-Agent-Linux64.bin -help

| 旗標描述
|:--|:--|
| -s | 執行沒有使用者提示靜音自動安裝。 |
| -檢查 | 檢查權限與作業系統，但不會安裝代理程式。 |

相依性代理程式的檔案會放置在下列目錄。

| 檔案 | 位置 |
|:--|:--|
| 核心檔案 | /usr/lib/bluestripe-collector |
| 記錄檔 | /var/opt/microsoft/dependency-agent/log |
| 設定檔 | /etc/opt/microsoft/dependency-agent/config |
| 服務可執行檔 | /sbin/bluestripe-collector<br>/sbin/bluestripe-collector-manager |
| 二進位儲存的檔案 | /var/opt/microsoft/dependency-agent/storage |



## <a name="troubleshooting"></a>疑難排解
如果您遇到問題應用程式相依性監視器，您可以從多個元件使用下列資訊來收集疑難排解資訊。

### <a name="windows-agents"></a>Windows 代理程式

#### <a name="microsoft-dependency-agent"></a>Microsoft 相依性代理程式
若要從相依性代理程式產生疑難排解的資料，開啟命令提示字元以系統管理員身分並執行下列命令 CollectBluestripeData.vbs 指令碼。  您可以新增--說明標幟] 來顯示更多選項。

    cd C:\Program Files\Bluestripe\Collector\scripts
    cscript CollectDependencyData.vbs

支援的資料套件會儲存於目前的使用者 %USERPROFILE%目錄。  您可以使用--檔案<filename>選項，將其儲存到不同的位置。

#### <a name="microsoft-dependency-agent-management-pack-for-mma"></a>Microsoft 相依性代理程式 Management Pack for MMA
相依性代理程式 Management Pack 執行 Microsoft 管理代理程式內。  它會接收來自相依性代理程式的資料，並將它轉寄給 ADM 雲端服務。
  
請確認管理套件下載的藉由執行下列步驟。

1.  尋找名 Microsoft.IntelligencePacks.ApplicationDependencyMonitor.mp C:\Program Files\Microsoft 監控 Agent\Agent\Health 服務 State\Management 組件中的檔案。  
2.  如果檔案沒有代理程式連線至是 SCOM 管理群組，然後確認，將其匯入是 SCOM，請核取 [系統管理工作區中的操作主控台的管理組件。

ADM MP 寫入作業管理員 Windows 事件記錄檔的事件。  記錄檔可以[OMS 中搜尋](../log-analytics/log-analytics-log-searches.md)系統記錄方案，透過您可以在其中設定上傳的記錄檔。  如果您啟用偵錯事件，他們會寫入到應用程式的事件記錄，與事件來源*AdmProxy*。

#### <a name="microsoft-monitoring-agent"></a>Microsoft 監控代理程式
收集診斷追蹤開啟命令提示字元以系統管理員身分，請執行下列命令︰ 

    cd \Program Files\Microsoft Monitoring Agent\Agent\Tools
    net stop healthservice 
    StartTracing.cmd ERR
    net start healthservice

追蹤會寫入到 c:\Windows\Logs\OpsMgrTrace。  您可以停止與 StopTracing.cmd 追蹤。


### <a name="linux-agents"></a>Linux 代理程式

#### <a name="microsoft-dependency-agent"></a>Microsoft 相依性代理程式
若要產生相依性代理程式 sudo 或根權限的權限的帳戶登入的疑難排解的資料，並執行下列命令。  您可以新增--說明標幟] 來顯示更多選項。

    /usr/lib/bluestripe-collector/scripts/collect-dependency-agent-data.sh

支援的資料套件會儲存到 /var/opt/microsoft/dependency-agent/log (如果根) 在 [代理程式的安裝目錄，或執行指令碼 （如果非根） 的使用者的主目錄。  您可以使用--檔案<filename>選項，將其儲存到不同的位置。

#### <a name="microsoft-dependency-agent-fluentd-plug-in-for-linux"></a>Microsoft 相依性代理程式 Fluentd Linux 外掛程式
相依性代理程式 Fluentd 外掛程式執行內 OMS Linux 代理程式。  它會接收來自相依性代理程式的資料，並將它轉寄給 ADM 雲端服務。  

下列兩個檔案會寫入記錄檔。

- /var/opt/microsoft/omsagent/log/omsagent.log
- /var/log/messages

#### <a name="oms-agent-for-linux"></a>Linux OMS 代理程式
疑難排解連線 OMS Linux 伺服器資源可以在這裡找到︰ [https://github.com/Microsoft/OMS-Agent-for-Linux/blob/master/docs/Troubleshooting.md](https://github.com/Microsoft/OMS-Agent-for-Linux/blob/master/docs/Troubleshooting.md) 

Linux OMS 代理程式的記錄位於*/var/選擇/microsoft/omsagent/記錄/*。  

Omsconfig （代理程式設定） 的記錄位於*/var/選擇/microsoft/omsconfig/記錄/*。
 
提供效能指標資料的 OMI 和 SCX 元件的記錄位於*/var/選擇/omi/記錄/*和*/var/opt/microsoft/scx/log*。


## <a name="data-collection"></a>資料收集
您可以預期的每個代理程式傳輸約 25 MB 每日，根據如何複雜系統的相依性。  每 15 秒時，會以每個代理程式傳送 ADM 相依性資料。  

0.1%的系統記憶體和系統 CPU 的 0.1%，通常會耗費 ADM 代理程式。


## <a name="supported-operating-systems"></a>支援的作業系統
下列各節會列出的相依性代理程式的支援的作業系統。   32 位元架構不支援的任何作業系統。

### <a name="windows-server"></a>Windows Server
- Windows Server 2012 R2
- Windows Server 2012
- Windows Server 2008 R2 SP1

### <a name="windows-desktop"></a>Windows 桌面
- 附註︰ Windows 10 尚未支援
- Windows 8.1
- Windows 8
- Windows 7

### <a name="red-hat-enterprise-linux-centos-linux-and-oracle-linux-with-rhel-kernel"></a>紅色的角色企業 Linux CentOS Linux 與 Oracle Linux （含 RHEL 核心）
- 只有 「 預設 」 和 「 SMP Linux 核心版本支援。
- 非標準核心版本，例如 PAE 與 Xen，不支援的任何 Linux 通訊群組。 例如，不支援 「 2.6.16.21-0.8-xen 」 的版本字串的系統。
- 自訂核心，包括重新編譯的標準核心，則不受支援
- 不支援 centos 加上核心。
- Oracle 永不折損核心 (UEK) 涵蓋下列在不同區段中。


#### <a name="red-hat-linux-7"></a>紅色的角色 Linux 7
| 作業系統版本 | 核心版本 |
|:--|:--|
| 7.0 | 3.10.0-123 |
| 7.1 | 3.10.0-229 |
| 7.2 | 3.10.0-327 |

#### <a name="red-hat-linux-6"></a>紅色的角色 Linux 6
| 作業系統版本 | 核心版本 |
|:--|:--|
| 6.0 | 2.6.32-71 |
| 6.1 | 2.6.32-131 |
| 6.2 | 2.6.32-220 |
| 6.3 | 2.6.32-279 |
| 6.4 | 2.6.32-358 |
| 6.5 | 2.6.32-431 |
| 6.6 | 2.6.32-504 |
| 6.7 | 2.6.32-573 |
| 6.8 | 2.6.32-642 |

#### <a name="red-hat-linux-5"></a>紅色的角色 Linux 5
| 作業系統版本 | 核心版本 |
|:--|:--|
| 5.8 | 2.6.18-308 |
| 5.9 | 2.6.18-348 |
| 5.10 | 2.6.18-371 |
| 5.11 | 2.6.18-398<br>2.6.18-400<br>2.6.18-402<br>2.6.18-404<br>2.6.18-406<br>2.6.18-407<br>2.6.18-408<br>2.6.18-409<br>2.6.18-410<br>2.6.18-411 |

#### <a name="oracle-enterprise-linux-w-unbreakable-kernel-uek"></a>Oracle 企業 Linux 以永不折損核心 (UEK)

#### <a name="oracle-linux-6"></a>Oracle Linux 6
| 作業系統版本 | 核心版本
|:--|:--|
| 6.2 | Oracle 2.6.32-300 (UEK R1) |
| 6.3 | Oracle 2.6.39-200 (UEK R2) |
| 6.4 | Oracle 2.6.39-400 (UEK R2) |
| 6.5 | Oracle 2.6.39-400 (UEK R2 i386) |
| 6.6 | Oracle 2.6.39-400 (UEK R2 i386) |

#### <a name="oracle-linux-5"></a>Oracle Linux 5

| 作業系統版本 | 核心版本
|:--|:--|
| 5.8 | Oracle 2.6.32-300 (UEK R1) |
| 5.9 | Oracle 2.6.39-300 (UEK R2) |
| 5.10 | Oracle 2.6.39-400 (UEK R2) |
| 5.11 | Oracle 2.6.39-400 (UEK R2) |

#### <a name="suse-linux-enterprise-server"></a>SUSE Linux Enterprise Server

#### <a name="suse-linux-11"></a>SUSE Linux 11
| 作業系統版本 | 核心版本
|:--|:--|
| 11 | 2.6.27 |
| 11 SP1 | 2.6.32 |
| 11 SP2 | 3.0.13 |
| 11 SP3 | 3.0.76 |
| 11 SP4 | 3.0.101 |

#### <a name="suse-linux-10"></a>SUSE Linux 10
| 作業系統版本 | 核心版本
|:--|:--|
| 10 SP4 | 2.6.16.60 |

## <a name="diagnostic-and-usage-data"></a>診斷及使用方式的資料
Microsoft 會自動收集您使用的應用程式相依性監視器服務使用情況和效能資料。 Microsoft 會使用這項資料來提供，以及改善品質、 安全性和應用程式相依性監視器服務的完整性。 資料包含您的軟體等作業系統版本設定的相關資訊，也包含 IP 位址、 DNS 名稱，以及工作站名稱，以提供正確且有效的疑難排解功能。 我們不會收集名稱、 地址或其他連絡人的資訊。

如需有關資料收集與使用方式的詳細資訊，請參閱[Microsoft Online Services 隱私權聲明](https://go.microsoft.com/fwlink/?LinkId=512132)。



## <a name="next-steps"></a>後續步驟
- 瞭解如何一次[使用應用程式相依性監視器](operations-management-suite-application-dependency-monitor.md)，具有已部署及設定。
