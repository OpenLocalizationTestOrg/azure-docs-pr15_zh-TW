<properties
    pageTitle="自動縮放與應用程式服務環境 |Microsoft Azure"
    description="自動縮放與應用程式服務環境"
    services="app-service"
    documentationCenter=""
    authors="btardif"
    manager="wpickett"
    editor=""
/>

<tags
    ms.service="app-service"
    ms.workload="web"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/24/2016"
    ms.author="byvinyal"
/>

# <a name="autoscaling-and-app-service-environment"></a>自動縮放與應用程式服務環境

Azure 應用程式服務環境支援*自動縮放*。 您可以自動調整大小指標或排程的個別工作集區。

![自動調整大小選項工作者集區。][intro]

自動縮放會自動放大或縮小以符合您的預算，並或載入設定檔的應用程式服務環境最佳化您的資源使用狀況。

## <a name="configure-worker-pool-autoscale"></a>設定工作集區自動調整大小

您可以存取的自動調整大小功能工作者集區的 [**設定**] 索引標籤。

![背景工作集區的 [設定] 索引標籤。][settings-scale]

從這裡介面應很熟悉，因為它是相同的體驗，您就會看到當您不按比例縮放的應用程式服務方案。 

![手動的縮放設定。][scale-manual]

您也可以設定的自動調整大小的設定檔。

![自動調整大小的設定。][scale-profile]

幫助以在您的比例設定限制時，會自動調整大小的設定檔。 如此一來，您可以擁有一致的效能體驗藉由設定下限比例值 （1） 和預測 spend 首字放大設定上限 (2)。

![設定檔中的縮放設定。][scale-profile2]

定義的設定檔之後，您可以新增 [自動調整大小的規則，以調整向上或向下所定義的設定檔的範圍內的工作者集區中的執行個體數目。 自動調整大小規則會根據指標。

![縮放比例規則。][scale-rule]

 任何背景工作集區或前端指標可用來定義自動調整大小的規則。 這些計量是相同的度量，您可以監視資源刀圖形，或針對設定通知。

## <a name="autoscale-example"></a>自動調整大小的範例

自動調整大小的應用程式服務環境的最佳方式可以的案例說明所示。

本文說明所有必要的考量，當您設定自動調整大小。 本文會引導您進入播放，當您納入自動縮放會裝載於應用程式服務環境的應用程式服務環境的互動。

### <a name="scenario-introduction"></a>案例簡介

書成是具有移轉他所管理的工作負載的部分應用程式服務環境企業系統管理員。

應用程式服務環境被設定為手動的小數位數，如下所示︰

* **上層結束︰** 3
* **背景工作集區 1**: 10
* **背景工作集區 2**: 5
* **背景工作集區 3**: 5

背景工作集區 1 用於生產負載，而背景工作集區 2 和工作集區 3 適用於品質保證 (QA) 和開發工作量。

問與答和開發的應用程式服務方案被設定為手動的小數位數。 處理載入和流量的變化，生產應用程式服務方案會設定為 [自動調整大小。

書成是很熟悉應用程式。 他知道這是線條的商務 (LOB) 應用程式的員工使用不在辦公室時，最大使用量的時數載入是 9:00 AM 到 6:00 PM 之間。 當使用者完成該日之後的卸除使用方式。 超過最大使用量數時，仍有一些載入因為使用者可以從遠端存取應用程式，使用其行動裝置或常用的電腦。 生產應用程式服務方案已設定為 [自動調整大小根據 CPU 使用率使用下列規則︰

![特定 LOB 應用程式的設定。][asp-scale]

|   **自動調整大小的設定檔 – 多少個工作日 – 應用程式服務計劃**     |   **自動調整大小的設定檔 – 週末 – 應用程式服務計劃**     |
|   ----------------------------------------------------    |   ----------------------------------------------------    |
|   **名稱︰**星期名稱的設定檔                               |   **名稱︰**週末設定檔                               |
|   **來縮放︰**排程與效能的規則            |   **來縮放︰**排程與效能的規則            |
|   **設定檔︰**包含工作日                                   |   **設定檔︰**週末                                    |
|   **類型︰**循環                                    |   **類型︰**循環                                    |
|   **目標範圍︰** 5 到 20 的執行個體                     |   **目標範圍︰** 3 到 10 執行個體                     |
|   **天︰**星期一、 星期二、 星期三、 星期四、 星期五  |   **天︰**星期六、 星期日                              |
|   **開始時間︰** 9:00 AM                                 |   **開始時間︰** 9:00 AM                                 |
|   **時區︰**UTC 08                                   |   **時區︰**UTC 08                                   |
|                                                           |                                                           |
|   **自動調整大小規則 （縮放比例設定）**                           |   **自動調整大小規則 （縮放比例設定）**                           |
|   **資源︰**生產 （應用程式服務環境）      |   **資源︰**生產 （應用程式服務環境）      |
|   **公制︰**CPU %                                       |   **公制︰**CPU %                                       |
|   **作業︰**大於 60%                         |   **作業︰**大於 80%                         |
|   **工期︰** 5 分鐘                                 |   **工期︰** 10 分鐘的時間                                |
|   **時間彙總︰**平均值                           |   **時間彙總︰**平均值                           |
|   **巨集指令︰**計算增加 2                         |   **巨集指令︰**計算增加 1                         |
|   **製作出酷炫下 （分鐘）︰** 15                             |   **製作出酷炫下 （分鐘）︰** 20                             |
|                                                           |                                                           |
  	|   **自動調整大小規則 （比例向下）**                     |   **自動調整大小規則 （比例向下）**                         |
|   **資源︰**生產 （應用程式服務環境）      |   **資源︰**生產 （應用程式服務環境）      |
|   **公制︰**CPU %                                       |   **公制︰**CPU %                                       |
|   **作業︰**小於 30%                            |   **作業︰**小於 20%                            |
|   **工期︰** 10 分鐘的時間                                |   **工期︰** 15 分鐘                                |
|   **時間彙總︰**平均值                           |   **時間彙總︰**平均值                           |
|   **巨集指令︰**計算減少 1                         |   **巨集指令︰**計算減少 1                         |
|   **製作出酷炫下 （分鐘）︰** 20                             |   **製作出酷炫下 （分鐘）︰** 10                             |

### <a name="app-service-plan-inflation-rate"></a>應用程式服務方案擴大工資率

若要自動調整大小的設定應用程式服務方案執行每小時的最大速度。 此率可以會根據計算自動調整大小規則所提供的值。

瞭解及計算*應用程式服務方案擴大工資率*，是很重要的應用程式服務環境自動調整大小，因為背景工作集區的縮放比例變更瞬間完成的效能。

應用程式服務方案擴大工資率的計算方式為︰

![應用程式服務方案擴大比率的計算。][ASP-Inflation]

根據自動調整大小-星期設定檔的生產應用程式服務方案的縮放比例設定規則︰

![應用程式服務方案擴大率的工作日根據 [自動調整大小 – 縮放比例設定規則。][Equation1]

如果 [自動調整大小 – 縮放比例設定規則週末設定檔的生產應用程式服務方案，公式會解析為︰

![應用程式服務方案擴大率的週末根據 [自動調整大小 – 縮放比例設定規則。][Equation2]

此值也可以計算的向下調整作業。

根據 [自動調整大小 – 比例向下規則 Weekday 設定檔的生產應用程式服務方案可能看起來，如下所示︰

![應用程式服務方案擴大率的工作日根據 [自動調整大小 – 比例向下規則。][Equation3]

如果 [自動調整大小 – 比例向下規則週末設定檔的生產應用程式服務方案，公式會解析為︰  

![應用程式服務方案週末根據 [自動調整大小 – 比例向下規則的擴大率。][Equation4]

生產應用程式服務方案可以放大八個執行個體/小時週最大工資率和四個執行個體/小時期間週末。 它可以釋放執行個體的四個執行個體/小時週的最大速度和六個執行個體/小時期間週末。

多個應用程式服務方案裝載在背景工作集區中，如果您需要的所有應用程式服務方案正在擴大工資率總和計算*總擴大工資率*裝載的工作者資料庫中。

![總擴大工資率計算裝載於背景工作集區中的多個應用程式服務方案。][ASP-Total-Inflation]

### <a name="use-the-app-service-plan-inflation-rate-to-define-worker-pool-autoscale-rules"></a>若要定義工作者集區自動調整大小規則使用應用程式服務方案擴大工資率

背景工作集區來自動縮放設定的應用程式服務方案需要配置的容量緩衝該主機。 自動調整大小作業變大和縮小的應用程式服務方案，如有需要可讓緩衝。 最小的緩衝會計算所有應用程式服務方案擴大速度。

由於應用程式服務環境比例作業花一些時間以套用，進一步視需要進行縮放作業時可能發生的變更應該帳戶任何變更。 若要調整此延遲，建議您為最小的數字的執行個體新增使用導出所有應用程式服務方案擴大速度，每個自動調整大小作業。

此資訊，請使用下列自動調整大小的設定檔和規則，可以定義書成︰

![自動調整大小的設定檔規則 LOB 範例。][Worker-Pool-Scale]

|   **自動調整大小的設定檔 – 多少個工作日**                        |   **自動調整大小的設定檔 – 週末**                |
|   ----------------------------------------------------    |   --------------------------------------------    |
|   **名稱︰**星期名稱的設定檔                               |   **名稱︰**週末設定檔                       |
|   **來縮放︰**排程與效能的規則            |   **來縮放︰**排程與效能的規則    |
|   **設定檔︰**包含工作日                                   |   **設定檔︰**週末                            |
|   **類型︰**循環                                    |   **類型︰**循環                            |
|   **目標範圍︰** 13 到 25 執行個體                    |   **目標範圍︰** 6 到 15 執行個體             |
|   **天︰**星期一、 星期二、 星期三、 星期四、 星期五  |   **天︰**星期六、 星期日                      |
|   **開始時間︰** 7:00 AM                                 |   **開始時間︰** 9:00 AM                         |
|   **時區︰**UTC 08                                   |   **時區︰**UTC 08                           |
|                                                           |                                                   |
|   **自動調整大小規則 （縮放比例設定）**                           |   **自動調整大小規則 （縮放比例設定）**                   |
|   **資源︰**背景工作集區 1                             |   **資源︰**背景工作集區 1                     |
|   **公制︰**WorkersAvailable                            |   **公制︰**WorkersAvailable                    |
|   **作業︰**小於 8                              |   **作業︰**小於 3                      |
|   **工期︰** 20 分鐘                                |   **工期︰** 30 分鐘                        |
|   **時間彙總︰**平均值                           |   **時間彙總︰**平均值                   |
|   **巨集指令︰**計算增加 8                         |   **巨集指令︰**計算增加 3                 |
|   **製作出酷炫下 （分鐘）︰** 180                            |   **製作出酷炫下 （分鐘）︰** 180                    |
|                                                           |                                                   |
|   **自動調整大小規則 （比例向下）**                         |   **自動調整大小規則 （比例向下）**                 |
|   **資源︰**背景工作集區 1                             |   **資源︰**背景工作集區 1                     |
|   **公制︰**WorkersAvailable                            |   **公制︰**WorkersAvailable                    |
|   **作業︰**大於 8                           |   **作業︰**大於 3                   |
|   **工期︰** 20 分鐘                                |   **工期︰** 15 分鐘                        |
|   **時間彙總︰**平均值                           |   **時間彙總︰**平均值                   |
|   **巨集指令︰**計算減少 2                         |   **巨集指令︰**計算減少 3                 |
|   **製作出酷炫下 （分鐘）︰** 120                            |   **製作出酷炫下 （分鐘）︰** 120                    |

在設定檔中定義的目標範圍的計算方式 [最小的執行個體中的設定檔，應用程式服務方案 + 緩衝定義。

最大範圍會裝載於背景工作集區中的所有應用程式服務方案的最大範圍的總和。

縮放比例設定規則的增加計數應該會設定為至少 1 X 比例應用程式服務方案擴大工資率。

減少計算可以調整為 1/2 X 或縮放比例應用程式服務方案擴大工資率 1x 之間向下。

### <a name="autoscale-for-front-end-pool"></a>自動調整大小的前端資料庫

前端自動調整大小的規則會比工作者集區。 您應該主要  
請務必持續時間的度量單位，而 cooldown 考慮比例作業應用程式服務方案不是瞬間完成的效能。

此案例中，書成知道錯誤工資率增加前端到達 80 %cpu 使用率之後，並設定自動調整大小規則增加執行個體，如下所示︰

![自動調整大小的前端資料庫的設定。][Front-End-Scale]

|   **自動調整大小的設定檔 – 前端**              |
|   --------------------------------------------    |
|   **名稱︰**自動調整大小 – 前端                |
|   **來縮放︰**排程與效能的規則    |
|   **設定檔︰**每天                           |
|   **類型︰**循環                            |
|   **目標範圍︰** 3 到 10 執行個體             |
|   **天︰**每天                              |
|   **開始時間︰** 9:00 AM                         |
|   **時區︰**UTC 08                           |
|                                                   |
|   **自動調整大小規則 （縮放比例設定）**                   |
|   **資源︰**前端資料庫                    |
|   **公制︰**CPU %                               |
|   **作業︰**大於 60%                 |
|   **工期︰** 20 分鐘                        |
|   **時間彙總︰**平均值                   |
|   **巨集指令︰**計算增加 3                 |
|   **製作出酷炫下 （分鐘）︰** 120                    |
|                                                   |
|   **自動調整大小規則 （比例向下）**                 |
|   **資源︰**背景工作集區 1                     |
|   **公制︰**CPU %                               |
|   **作業︰**小於 30%                    |
|   **工期︰** 20 分鐘                        |
|   **時間彙總︰**平均值                   |
|   **巨集指令︰**計算減少 3                 |
|   **製作出酷炫下 （分鐘）︰** 120                    |

<!-- IMAGES -->
[intro]: ./media/app-service-environment-auto-scale/introduction.png
[settings-scale]: ./media/app-service-environment-auto-scale/settings-scale.png
[scale-manual]: ./media/app-service-environment-auto-scale/scale-manual.png
[scale-profile]: ./media/app-service-environment-auto-scale/scale-profile.png
[scale-profile2]: ./media/app-service-environment-auto-scale/scale-profile-2.png
[scale-rule]: ./media/app-service-environment-auto-scale/scale-rule.png
[asp-scale]: ./media/app-service-environment-auto-scale/asp-scale.png
[ASP-Inflation]: ./media/app-service-environment-auto-scale/asp-inflation-rate.png
[Equation1]: ./media/app-service-environment-auto-scale/equation1.png
[Equation2]: ./media/app-service-environment-auto-scale/equation2.png
[Equation3]: ./media/app-service-environment-auto-scale/equation3.png
[Equation4]: ./media/app-service-environment-auto-scale/equation4.png
[ASP-Total-Inflation]: ./media/app-service-environment-auto-scale/asp-total-inflation-rate.png
[Worker-Pool-Scale]: ./media/app-service-environment-auto-scale/wp-scale.png
[Front-End-Scale]: ./media/app-service-environment-auto-scale/fe-scale.png
